<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub File Explorer</title>
    <style>
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ (ì´ ë¶€ë¶„ì„ ìˆ˜ì •í•´ì„œ ë‹¤í¬ëª¨ë“œë¥¼ ì—°ìŠµí•´ë³´ì„¸ìš”!) */
        body { font-family: -apple-system, sans-serif; line-height: 1.6; max-width: 800px; margin: 40px auto; padding: 0 20px; background-color: #ffffff; color: #24292e; }
        h1 { border-bottom: 1px solid #eaecef; padding-bottom: .3em; }
        ul { list-style: none; padding: 0; }
        li { border-bottom: 1px solid #e1e4e8; padding: 12px 0; display: flex; align-items: center; }
        a { color: #0366d6; text-decoration: none; font-weight: 500; cursor: pointer; }
        a:hover { text-decoration: underline; }
        .icon { margin-right: 12px; width: 20px; text-align: center; }
        .breadcrumb { margin-bottom: 20px; color: #586069; }
        .breadcrumb a { color: #586069; font-weight: normal; }
        .btn-back { margin-bottom: 15px; display: inline-block; color: #6a737d; font-size: 0.9em; }
    </style>
</head>
<body>

    <h1 id="repo-title">Loading...</h1>
    
    <div class="breadcrumb" id="breadcrumb">
        </div>

    <ul id="file-list">
        <li>ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</li>
    </ul>

    <script>
        // 1. ì„¤ì •: ì‚¬ìš©ì ì •ë³´ ì¶”ì¶œ
        const user = window.location.hostname.split('.')[0];
        const repo = window.location.pathname.split('/')[1];
        
        // 2. í˜„ì¬ ê²½ë¡œ íŒŒì•… (?path=... íŒŒë¼ë¯¸í„° ì½ê¸°)
        const urlParams = new URLSearchParams(window.location.search);
        const currentPath = urlParams.get('path') || "";

        async function renderFiles() {
            const fileListElement = document.getElementById('file-list');
            document.getElementById('repo-title').innerText = repo;

            // ë¸Œë ˆë“œí¬ëŸ¼(ê²½ë¡œ í‘œì‹œ) ìƒì„±
            updateBreadcrumb();

            try {
                // API í˜¸ì¶œ ì‹œ ê²½ë¡œ(path) ì§€ì •
                const response = await fetch(`https://api.github.com/repos/${user}/${repo}/contents/${currentPath}`);
                const items = await response.json();

                if (!Array.isArray(items)) {
                    fileListElement.innerHTML = '<li>ë‚´ìš©ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</li>';
                    return;
                }

                fileListElement.innerHTML = '';

                // ìƒìœ„ í´ë”ë¡œ ê°€ê¸° ë²„íŠ¼ (ë£¨íŠ¸ê°€ ì•„ë‹ ë•Œë§Œ)
                if (currentPath !== "") {
                    const backLi = document.createElement('li');
                    backLi.innerHTML = `<span class="icon">â¤´ï¸</span><a href="?path=${getParentPath(currentPath)}">.. (ìƒìœ„ í´ë”)</a>`;
                    fileListElement.appendChild(backLi);
                }

                items.forEach(item => {
                    // í˜„ì¬ index.html íŒŒì¼ì€ ëª©ë¡ì—ì„œ ì œì™¸
                    if (item.path === 'index.html') return;

                    const li = document.createElement('li');
                    const isDir = item.type === 'dir';
                    const icon = isDir ? 'ğŸ“' : 'ğŸ“„';
                    
                    // í´ë”ë©´ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¥¼ ë³€ê²½í•˜ê³ , íŒŒì¼ì´ë©´ ì‹¤ì œ ê²½ë¡œë¡œ ì—°ê²°
                    const linkHref = isDir 
                        ? `?path=${encodeURIComponent(item.path)}` 
                        : item.html_url; // ì†ŒìŠ¤ ì½”ë“œë¥¼ ë³´ë ¤ë©´ html_url, ì§ì ‘ ì‹¤í–‰í•˜ë ¤ë©´ item.path

                    li.innerHTML = `<span class="icon">${icon}</span><a href="${linkHref}">${item.name}</a>`;
                    fileListElement.appendChild(li);
                });

            } catch (error) {
                fileListElement.innerHTML = '<li>ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. API í˜¸ì¶œ ì œí•œì„ í™•ì¸í•˜ì„¸ìš”.</li>';
            }
        }

        function getParentPath(path) {
            const parts = path.split('/');
            parts.pop();
            return parts.join('/');
        }

        function updateBreadcrumb() {
            const bc = document.getElementById('breadcrumb');
            let html = `<a href="?path=">${repo}</a>`;
            const parts = currentPath.split('/').filter(p => p);
            
            let accumulatedPath = "";
            parts.forEach(part => {
                accumulatedPath += (accumulatedPath ? '/' : '') + part;
                html += ` / <a href="?path=${encodeURIComponent(accumulatedPath)}">${part}</a>`;
            });
            bc.innerHTML = html;
        }

        renderFiles();
    </script>
</body>
</html>
